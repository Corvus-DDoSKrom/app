'use strict'

const toggleClass = (element, className) => {
  element.classList.toggle(className)
}

const addClass = (element, className) => {
  element.classList.add(className)
}

const removeClass = (element, className) => {
  element.classList.remove(className)
}

const handleDropdownClick = (event) => {
  const dropdown = event.currentTarget
  if (dropdown.classList.contains('navbar-item')) {
    toggleClass(dropdown, 'active')
  } else {
    const mdiIcon = dropdown.getElementsByClassName('mdi')[1]
    const parent = dropdown.parentNode
    toggleClass(parent, 'active')
    toggleClass(mdiIcon, 'mdi-plus')
    toggleClass(mdiIcon, 'mdi-minus')
  }
}

const handleMobileAsideButtonClick = (event) => {
  const icon = event.currentTarget.getElementsByClassName('icon')[0].getElementsByClassName('mdi')[0]
  toggleClass(document.documentElement, 'aside-mobile-expanded')
  toggleClass(icon, 'mdi-forwardburger')
  toggleClass(icon, 'mdi-backburger')
}

const handleNavbarMenuToggleClick = (event) => {
  const icon = event.currentTarget.getElementsByClassName('icon')[0].getElementsByClassName('mdi')[0]
  const targetId = event.currentTarget.getAttribute('data-target')
  toggleClass(document.getElementById(targetId), 'active')
  toggleClass(icon, 'mdi-dots-vertical')
  toggleClass(icon, 'mdi-close')
}

const handleModalClick = (event) => {
  const targetId = event.currentTarget.getAttribute('data-target')
  addClass(document.getElementById(targetId), 'active')
  addClass(document.documentElement, 'clipped')
}

const handleModalCloseClick = (event) => {
  const modal = event.currentTarget.closest('.modal')
  removeClass(modal, 'active')
  removeClass(document.documentElement, 'clipped')
}

const handleNotificationDismissClick = (event) => {
  const notification = event.currentTarget.closest('.notification')
  addClass(notification, 'hidden')
}

Array.from(document.getElementsByClassName('dropdown')).forEach((dropdown) => {
  dropdown.addEventListener('click', handleDropdownClick)
})

Array.from(document.getElementsByClassName('mobile-aside-button')).forEach((button) => {
  button.addEventListener('click', handleMobileAsideButtonClick)
})

Array.from(document.getElementsByClassName('--jb-navbar-menu-toggle')).forEach((toggle) => {
  toggle.addEventListener('click', handleNavbarMenuToggleClick)
})

Array.from(document.getElementsByClassName('--jb-modal')).forEach((modal) => {
  modal.addEventListener('click', handleModalClick)
})

Array.from(document.getElementsByClassName('--jb-modal-close')).forEach((closeButton) => {
  closeButton.addEventListener('click', handleModalCloseClick)
})

Array.from(document.getElementsByClassName('--jb-notification-dismiss')).forEach((dismissButton) => {
  dismissButton.addEventListener('click', handleNotificationDismissClick)
})
